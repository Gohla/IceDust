<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="all" name="Relations">
   
		<!-- overwrite the generated file to not generate from sdf3 for speed improvement -->
		<!-- The files for which the on-save handler is called before building. -->
		<path id="call-onsave.files">
			<fileset dir=".">
				<include name="**/*.nab"/>
				<include name="**/*.ts"/>
			</fileset>
		</path>
	
    <!-- Key input modules -->
    <property name="sdfmodule" value="Relations"/>
    <property name="ppmodule" value="${sdfmodule}-pp"/>
  <property name="sigmodule" value="${sdfmodule}-sig"/>
  <property name="metasdfmodule" value="Stratego-Relations"/>
    <property name="esvmodule" value="Relations"/>
    <property name="strmodule" value="relations"/>

    <!-- Project directories -->
    <property location="trans" name="trans"/>
    <property location="editor/java" name="src-gen"/>
    <property location="src-gen/syntax" name="syntax"/>
    <property location="include" name="include"/>
    <property location="lib" name="lib"/>
    <property location="src-gen" name="sdf-src-gen"/>
  <property location="${sdf-src-gen}/pp" name="pp"/>
  <property location="${sdf-src-gen}/signatures" name="signatures"/>
  <property location="${include}" name="lib-gen"/>
  <property location="${syntax}" name="syntax.rel" relative="yes"/>
  <property location="${trans}" name="trans.rel" relative="yes"/>
  <property location="${include}" name="include.rel" relative="yes"/>
  <property location="${lib-gen}" name="lib-gen.rel" relative="yes"/>
  <property location="target/classes" name="build"/>
    <property location="bin/dist" name="dist"/>
    
    <!-- Imports -->
    <property name="build.sdf.imports" value=""/>
    <property name="build.stratego.args" value="                     --library                     -I &quot;${trans}&quot;                     -I &quot;${basedir}&quot;                     -la stratego-lib -la stratego-sglr -la stratego-gpp -la stratego-xtc -la stratego-aterm -la stratego-parallel"/>
    
    <!-- Optional: external .def and .jar locations
    <property name="externaldef" location="syntax/${sdfmodule}.def"/>
    <property name="externaljar" value="../lib.jar"/>
    <property name="externaljarflags" value="-la org.lib"/>
    -->
	
	<target name="os-detection">
	<condition property="isWin">
	<os family="windows" />
	</condition>
	</target>

	<target name="copy-lib-files" if="isWin" depends="os-detection">
	<copy todir="${basedir}/lib/nabl">
	<fileset dir="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/nabl/" includes="**" />
	</copy>
	<copy todir="${basedir}/lib/index">
	<fileset dir="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/index/" includes="**" />
	</copy>
	<copy todir="${basedir}/lib/task">
	<fileset dir="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/task/" includes="**" />
	</copy>
	<copy todir="${basedir}/lib/types">
	<fileset dir="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/types/" includes="**" />
	</copy>
	<copy todir="${basedir}/lib/analysis">
	<fileset dir="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/analysis/" includes="**" />
	</copy>
	<copy todir="${basedir}/lib/editor">
	<fileset dir="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/editor/" includes="**" />
	</copy>
	<copy todir="${basedir}/lib/properties">
	<fileset dir="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/properties/" includes="**" />
	</copy>
	<copy todir="${basedir}/lib/tmpl">
	<fileset dir="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/tmpl/" includes="**" />
	</copy>
	<copy todir="${basedir}/lib/relations">
	<fileset dir="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/relations/" includes="**" />
	</copy>
		
	</target>

	<target name="link-lib-files" unless="isWin" depends="os-detection">
	<symlink resource="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/nabl/" link="${basedir}/lib/nabl" overwrite="true" />
	<symlink resource="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/index/" link="${basedir}/lib/index" overwrite="true" />
	<symlink resource="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/task/" link="${basedir}/lib/task" overwrite="true" />
	<symlink resource="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/types/" link="${basedir}/lib/types" overwrite="true" />
	<symlink resource="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/analysis/" link="${basedir}/lib/analysis" overwrite="true" />
	<symlink resource="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/editor/" link="${basedir}/lib/editor" overwrite="true" />
	<symlink resource="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/properties/" link="${basedir}/lib/properties" overwrite="true" />
	<symlink resource="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/tmpl/" link="${basedir}/lib/tmpl" overwrite="true" />
	<symlink resource="${basedir}/../../runtime-libraries/org.spoofax.meta.runtime.libraries/relations/" link="${basedir}/lib/relations" overwrite="true" />
	</target>

    <!-- Environment configuration for command-line builds -->
    <property name="nativepath" value="${eclipse.spoofaximp.nativeprefix}"/>
  <condition else="" property="build.strategoxt.sdf" value="${eclipse.spoofaximp.nativeprefix}">
        <isset property="eclipse.spoofaximp.nativeprefix"/>
    </condition>
    <property location="${user.home}/.nix-profile/bin" name="build.strategoxt.stratego"/>
		
    <!-- used for building inside of Eclipse -->
    <import file="build.generated.xml"/>   

    <!-- Main target -->
		<!-- <target depends="copy-lib-files,link-lib-files,spoofaximp.default.jar" name="all"/> -->
    <target depends="spoofaximp.default.jar" name="all"/>
<target depends="generate-sources-java" name="generate-sources"/>
  <target depends="package-java" name="package"/>
</project>
