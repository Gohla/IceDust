module Model

imports
	Common
	Expressions
	Types

context-free syntax // entities

	Model.Entity = <
		<EntityOrRelation> <ID> {
			<{Member "\n"}*>
		}
	>
	EntityOrRelation.EntityType = <entity>
	EntityOrRelation.RelationType = <relation>

context-free syntax // shortcut relations

  Model.ShortcutRelation = [
    relation [ID].[ID] [Multiplicity?] [Ordering?] <-> [Multiplicity?] [Ordering?] [ID].[ID] {
      [{Attribute "\n"}*]
    }
  ]

context-free syntax // entity members

	Member											= <<Attribute>>
	Member											= <<Role>>
	Member											= <<Shortcut>>

	Attribute.Attribute 				= <<ID> : <PrimitiveType> <Multiplicity?> <Derivation?>>
	Derivation.Derivation 			= <= <Exp> <DerivationType>>
	DerivationType.DefaultValue	= <(default)>
	DerivationType.Derivation		= <>

	Role.Role										= <<ID> <Multiplicity> <Ordering?> <ID?> <Inverse?>>
	Inverse											= <\<- <ID>>
	//TODO: test sdf2 version          ID Multiplicity ID? ("<-" ID)? -> Role {"Role"}

	Shortcut.Shortcut						= <<RoleRef>.<ID> \<-\> <RoleRef>.<ID>>

context-free syntax // specific references
	
	EntityRef.EntityRef 				= ID
	AttributeRef.AttributeRef   = ID
	RoleRef.RoleRef							= ID
