/**
* Entity and attributes tests
*/
module test-relation

language Relations

setup Common [[
  module test
]]

test Simple relation [[
	entity User{}
	entity Book{}
	relation Owns{
		User *
		Book 1
	}
]] 0 errors

test Resolve entity type fails [[
	entity User{}
	entity Book{}
	relation Owns{
		User *
		Paper 1
	}
]] 1 errors

test Duplicate relation fails [[
	entity User{}
	entity Book{}
	relation Owns{
		User *
		Book 1
	}
	relation Owns{
		User *
		Book 1
	}
]] 2 errors

test Name resolve relation member to entity [[
	entity [[User]]{}
	entity Book{}
	relation Owns{
		[[User]] *
		Book 1
	}
]] resolve #2 to #1

test Name resolve relation member to entity in graph [[
	relation [[GraphNode]]{
		[[GraphNode]] *
	}
]] resolve #2 to #1

test Name resolve relation member to entity in tree [[
	relation [[TreeNode]]{
		TreeNode ? parent
		[[TreeNode]] * children
	}
]] resolve #2 to #1

// should give a duplication error, which is resolved by adding role names!
// test Name resolve relation member to entity in binary tree [[
// 	relation BinaryTreeNode{
// 		BinaryTreeNode 1
// 		BinaryTreeNode 1
// 	}
// ]] 0 errors

